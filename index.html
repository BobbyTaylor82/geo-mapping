<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Bootcamp</title>

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

    <!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    <!-- Latest compiled JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>



    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css" integrity="sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ=="
        crossorigin="" />
    <!-- Make sure you put this AFTER Leaflet's CSS -->
    <script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js" integrity="sha512-/Nsx9X4HebavoBvEBuyp3I7od5tA0UzAxs+j83KgC8PU0kgB4XiK4Lfe4y4cgBtaRJQEIFCW+oC506aPT2L1zw=="
        crossorigin=""></script>


    <!--D3 cdn-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.5.0/d3.min.js"></script>



    <style>
        /* remove default margin and padding from body */

        body {
            padding: 0;
            margin: 0;
        }

        /* set map, body, and html to 100% of the screen size */

        #map,
        body,
        html {
            height: 100%;
        }

        #header {
            background-color: black;
            color: whitesmoke;
            border-bottom: blue 5px solid;

            font-family: 'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana, sans-serif;

        }


        .legend {
            line-height: 18px;
            color: #555;
        }

        .legend i {
            width: 18px;
            height: 18px;
            float: left;
            margin-right: 8px;
            opacity: 0.7;
        }
    </style>
</head>

<body>


    <div id="header" class="jumbotron" style="text-align:center">
        <h1>Geo-Mapping: Earthquakes </h1>
    </div>

    <div id="map" style="margin-top: -30px;"></div>

    <script>
        // Creating map object
        var myMap = L.map("map", {
            center: [51.508, -0.11],
            zoom: 3

        });

        // Adding tile layer
        L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}', {
            attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, ' +
                '<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="http://mapbox.com">Mapbox</a>',
            maxZoom: 18,
            id: 'mapbox.streets-satellite',
            accessToken: 'pk.eyJ1IjoiYmx0eHI5IiwiYSI6ImNqZGhqeXhtOTB6ZDAzMm8xamo5cHRmb3cifQ.lUfEpXhv5BlcfZ2c2gVLtQ'
        }).addTo(myMap);

        // Store our API endpoint inside queryUrl

        var queryUrl = "https://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/all_week.geojson";


        



        // used d3.json to read geoJSON file

        d3.json(queryUrl, function (data) {
            var file = data;

            // create map from geoJSON object and markers

            L.geoJSON(file, {
                pointToLayer: function (feature, latlng) {
                    // console.log(feature)
                    // change marker colors based on size

                   function getColor(d) {
                        return  d > 3.5 ? 'white' :
                                d > 3 ? 'pink' :
                                d > 2.5 ? 'orange' :
                                d > 2 ? 'black' :
                                d > 1.5 ? 'red' :
                                d > 1 ? 'blue' :
                                d > .5 ? 'yellow' :
                                         '#FFEDA0';
                    };

                   


                    // generate circleMarker for earthquake values

                    var geojsonMarkerOptions = {
                        radius: feature.properties.mag * 4,
                        fillColor: getColor(feature.properties.mag),
                        color: "black",
                        weight: 1,
                        opacity: 1,
                        fillOpacity: 0.8
                    };
                    return L.circleMarker(latlng, geojsonMarkerOptions)
                        .bindPopup("<h5>" + feature.properties.place + "</h5>" +
                            "<hr>" +
                            "<p>" + "Magnitude of earthquake:" + "</p>" +
                            feature.properties.mag
                        );
                }
            }).addTo(myMap);


            var legend = L.control({
                position: 'bottomright'
            });

            legend.onAdd = function (map) {

                var div = L.DomUtil.create('div', 'info legend');
                    
                
                var grades = [.5, 1, 1.5, 2, 2.5, 3, 3.5];
                    
                var labels = [];

                
               

                // loop through our density intervals and generate a label with a colored square for each interval
                for (var i = 0; i < grades.length; i++) {
                    div.innerHTML +=
                        "<i style='background:" + getColor(grades[i] + 1) + "'></i> " +
                        grades[i] + (grades[i + 1] ? "&ndash;" + grades[i + 1] + "<br>" : "+");
                }
                
                return div;

                
            };

                   

          
            legend.addTo(myMap);




        });
    </script>
</body>

</html>